#!/bin/sh
# preinst script for ts3client
#
# see: dh_installdeb(1)

set -e

# summary of how this script can be called:
#        * <new-preinst> `install'
#        * <new-preinst> `install' <old-version>
#        * <new-preinst> `upgrade' <old-version>
#        * <old-preinst> `abort-upgrade' <new-version>
# for details, see https://www.debian.org/doc/debian-policy/ or
# the debian-policy package

agreement_license() {
        license="$(cat "${0}" | sed '0,/^exit 0$/d')"

        if [ -n "${license}" ]
        then
                read -p "Welcome to the TeamSpeak 3 Client for Linux on amd64 installer

In order to install this software you are required to accept the license
agreement, please press return to view the license.

You can scroll with the arrow keys and quit the viewer by pressing 'q'.
[RETURN]" return_key

                echo "${license}" | less
                while true
                do
                        read -p "Please type y to accept, n otherwise: " yn
                        case "${yn}" in
                                y|Y)
                                        exit 0
                                ;;
                                n|N)
                                        exit 1
                                ;;
                        esac
                done
        fi
}

case "$1" in
    install|upgrade)
        agreement_license
    ;;

    abort-upgrade)
    ;;

    *)
        echo "preinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
